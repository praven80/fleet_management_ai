"use strict";(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[779],{9779:(e,t,r)=>{r.d(t,{EventStreamSerde:()=>c});var i=r(9379),n=r(4705),a=r(6218),s=r(600),o=r(9495),l=r(684),d=r(7537);class c{constructor(e){let{marshaller:t,serializer:r,deserializer:i,serdeContext:a,defaultContentType:s}=e;(0,n.A)(this,"marshaller",void 0),(0,n.A)(this,"serializer",void 0),(0,n.A)(this,"deserializer",void 0),(0,n.A)(this,"serdeContext",void 0),(0,n.A)(this,"defaultContentType",void 0),this.marshaller=t,this.serializer=r,this.deserializer=i,this.serdeContext=a,this.defaultContentType=s}async serializeEventStream(e){let{eventStream:t,requestSchema:r,initialRequest:n}=e;const l=this.marshaller,d=r.getEventStreamMember(),c=r.getMemberSchema(d),u=this.serializer,y=this.defaultContentType,v=Symbol("initialRequestMarker"),h={[Symbol.asyncIterator]:()=>(0,s.A)(function*(){if(n){const e={":event-type":{type:"string",value:"initial-request"},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:y}};u.write(r,n);const t=u.flush();yield{[v]:!0,headers:e,body:t}}var e,i=!1,s=!1;try{for(var l,d=(0,o.A)(t);i=!(l=yield(0,a.A)(d.next())).done;i=!1){const e=l.value;yield e}}catch(c){s=!0,e=c}finally{try{i&&null!=d.return&&(yield(0,a.A)(d.return()))}finally{if(s)throw e}}})()};return l.serialize(h,e=>{var t;if(e[v])return{headers:e.headers,body:e.body};const r=null!==(t=Object.keys(e).find(e=>"__type"!==e))&&void 0!==t?t:"",{additionalHeaders:n,body:a,eventType:s,explicitPayloadContentType:o}=this.writeEventBody(r,c,e);return{headers:(0,i.A)({":event-type":{type:"string",value:s},":message-type":{type:"string",value:"event"},":content-type":{type:"string",value:null!==o&&void 0!==o?o:y}},n),body:a}})}async deserializeEventStream(e){var t;let{response:r,responseSchema:n,initialResponseContainer:o}=e;const d=this.marshaller,c=n.getEventStreamMember(),u=n.getMemberSchema(c).getMemberSchemas(),y=Symbol("initialResponseMarker"),v=d.deserialize(r.body,async e=>{var t;const r=null!==(t=Object.keys(e).find(e=>"__type"!==e))&&void 0!==t?t:"",a=e[r].body;if("initial-response"===r){const e=await this.deserializer.read(n,a);return delete e[c],(0,i.A)({[y]:!0},e)}if(r in u){const t=u[r];if(t.isStructSchema()){const i={};let n=!1;for(const[c,u]of t.structIterator()){const{eventHeader:t,eventPayload:y}=u.getMergedTraits();if(n=n||Boolean(t||y),y)if(u.isBlobSchema())i[c]=a;else if(u.isStringSchema()){var s,o;i[c]=(null!==(s=null===(o=this.serdeContext)||void 0===o?void 0:o.utf8Encoder)&&void 0!==s?s:l.P)(a)}else u.isStructSchema()&&(i[c]=await this.deserializer.read(u,a));else if(t){var d;const t=null===(d=e[r].headers[c])||void 0===d?void 0:d.value;null!=t&&(u.isNumericSchema()?i[c]=t&&"object"===typeof t&&"bytes"in t?BigInt(t.toString()):Number(t):i[c]=t)}}if(n)return{[r]:i}}return{[r]:await this.deserializer.read(t,a)}}return{$unknown:e}}),h=v[Symbol.asyncIterator](),m=await h.next();if(m.done)return v;if(null!==(t=m.value)&&void 0!==t&&t[y]){if(!n)throw new Error("@smithy::core/protocols - initial-response event encountered in event stream but no response schema given.");for(const[e,t]of Object.entries(m.value))o[e]=t}return{[Symbol.asyncIterator]:()=>(0,s.A)(function*(){var e;for(null!==m&&void 0!==m&&null!==(e=m.value)&&void 0!==e&&e[y]||(yield m.value);;){const{done:e,value:t}=yield(0,a.A)(h.next());if(e)break;yield t}})()}}writeEventBody(e,t,r){var i,n;const a=this.serializer;let s,o=e,l=null;const c={};if(t.getSchema()[4].includes(e)){const i=t.getMemberSchema(e);if(!i.isStructSchema())throw new Error("@smithy/core/event-streams - non-struct member not supported in event stream union.");for(const[t,n]of i.structIterator()){const{eventHeader:i,eventPayload:a}=n.getMergedTraits();if(a){l=t;break}if(i){const i=r[e][t];let a="binary";n.isNumericSchema()?a=(-2)**31<=i&&i<=2**31-1?"integer":"long":n.isTimestampSchema()?a="timestamp":n.isStringSchema()?a="string":n.isBooleanSchema()&&(a="boolean"),null!=i&&(c[t]={type:a,value:i},delete r[e][t])}}if(null!==l){const t=i.getMemberSchema(l);t.isBlobSchema()?s="application/octet-stream":t.isStringSchema()&&(s="text/plain"),a.write(t,r[e][l])}else a.write(i,r[e])}else{const[t,i]=r[e];o=t,a.write(15,i)}const u=a.flush();return{body:"string"===typeof u?(null!==(i=null===(n=this.serdeContext)||void 0===n?void 0:n.utf8Decoder)&&void 0!==i?i:d.a)(u):u,eventType:o,explicitPayloadContentType:s,additionalHeaders:c}}}}}]);
//# sourceMappingURL=779.5df523fe.chunk.js.map